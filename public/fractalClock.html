<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Fractal Clock</title>
</head>

<body onload="init()">
<canvas id="canvas" width="800" height="800" style="background-color:black"></canvas>
<script>
	debugger;

	var canvas = document.getElementById("canvas");
	var ctx = canvas.getContext("2d");
	var radius = canvas.height / 2;
	var startDepth = 9;

	function init(){

		var w = window.innerWidth
		|| document.documentElement.clientWidth
		|| document.body.clientWidth;

		var h = window.innerHeight
		|| document.documentElement.clientHeight
		|| document.body.clientHeight;

		canvas.width = w;
    	canvas.height = h;

		radius = canvas.height / 2;

		ctx.translate(canvas.width / 2, canvas.height / 2);
		radius = radius * 0.90;
		ctx.fillStyle="white";

		setInterval(drawClock, 1);
	}

	function drawClock() {

	    clearClock(ctx);
	    //drawFace(ctx, radius);
	    var now = new Date();
	    var hour = now.getHours();
	    var min = now.getMinutes();
	    var sec = now.getSeconds() + now.getMilliseconds() / 1000.0;
	    
	        //hour
	    hour=hour%12;
	    hour=(hour*Math.PI/6)+(min*Math.PI/(6*60))+(sec*Math.PI/(360*60));
	    
	    //minute
	    min=(min*Math.PI/30)+(sec*Math.PI/(30*60));
	    
	    // second
	    sec=(sec*Math.PI/30);  
	    
	    //drawNumbers(ctx, radius, sec);
	    drawTime(ctx, radius, hour, min, sec, startDepth);
	}

	function clearClock(ctx) {
	    ctx.save();
	    ctx.setTransform(1,0,0,1,0,0);
	    ctx.clearRect(0,0, canvas.width,canvas.height);
	    ctx.restore();
	}

	function drawFace(ctx, radius)
	{
	    ctx.arc(0, 0, radius, 0 , 2*Math.PI);
	    ctx.fillStyle = "white";
	    ctx.fill();
	}
	    
	function drawNumbers(ctx, radius, number)
	{
	    ctx.save();
	    ctx.setTransform(1,0,0,1,0.03 * radius, 0.03 * radius);
	    ctx.font = radius*0.05 + "px arial";
	    ctx.textBaseline="top";
	    ctx.textAlign="left";
	    ctx.fillText(number.toString(), 0, 0); 
	    ctx.restore();
	}

	function drawTime(ctx, radius, hour, min, sec, depth){
	    
	    if (depth <= 0) {
	        return 1;
	    }
	    
	    if(depth >= startDepth)
	    {
	        drawHand(ctx, hour, radius*0.125, hour, min, sec, depth);
	    }
	    else
	    {
	        //drawHand(ctx, hour, radius*0.125, hour, min, sec, depth);
	    }
	    drawHand(ctx, min, (radius*0.25)*(depth/startDepth), hour, min, sec, depth);
	    drawHand(ctx, sec, (radius*0.25)*(depth/startDepth), hour, min, sec, depth);
	    
	}

	function drawHand(ctx, pos, length, hour, min, sec, depth) {
	    if(depth >= startDepth)
	    {
	        ctx.lineWidth=1.75;
	        ctx.strokeStyle="rgba(255,255,255,1)";
	    }
	    else
	    {
	        ctx.lineWidth=1;
	        ctx.strokeStyle = 'rgba(255,255,255,' + (depth)/(startDepth * 2) + ')';    
	    }    
	    ctx.beginPath();
	    ctx.moveTo(0,0);
	    ctx.rotate(pos);
	    ctx.lineTo(0, -length);
	    ctx.stroke();
	    
	    if(pos != hour){
	        ctx.save();
	        ctx.translate(0, -length);
	        if(depth <= startDepth){
	        	//ct.rotate(-hour);
	        }
	        drawTime(ctx, radius, hour, min, sec, depth - 1);
	        ctx.restore();
	    }

	    ctx.rotate(-pos);
	    
	}
</script>	
</body>

</html>